<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cacao Drying Monitor Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --sidebar-width: 220px;
      --primary: #6f42c1;
      --bg-light: #f8f9fa;
      --card-bg: #e9ecef;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: var(--bg-light);
      color: #212529;
      display: flex;
    }
    .sidebar {
      position: fixed;
      top: 0; left: 0;
      width: var(--sidebar-width);
      height: 100vh;
      background: #343a40;
      color: #fff;
      padding-top: 1rem;
      overflow-y: auto;
    }
    .sidebar h2 {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
      margin: 0 0 1rem;
    }
    .nav-link {
      display: block;
      padding: 0.75rem 1rem;
      color: #fff;
      text-decoration: none;
    }
    .nav-link:hover { background: #495057; }
    .content {
      margin-left: var(--sidebar-width);
      padding: 1rem;
      width: calc(100% - var(--sidebar-width));
    }
    header {
      background: var(--primary);
      color: #fff;
      padding: 1rem;
      text-align: center;
      font-size: 1.6rem;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    .section {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.05);
      padding: 1rem;
      margin-bottom: 1.5rem;
    }
    .data-box {
      display: flex; flex-wrap: wrap;
      gap: 1rem; justify-content: space-around;
    }
    .sensor-card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1rem;
      width: 140px;
      text-align: center;
    }
    .sensor-card h3 { font-size: 1rem; margin: 0.5rem 0; }
    .sensor-card p { font-size: 1.5rem; font-weight: 600; margin: 0; }
    canvas { margin-top: 1rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #dee2e6; padding: 0.5rem; text-align: center; }
    th { background: var(--primary); color:#fff; }
    footer { text-align:center; font-size:0.85rem; color:#666; margin-top:2rem; }
    @media (max-width: 768px) {
      .sidebar { position: static; width: 100%; height: auto; }
      .content { margin-left: 0; width: 100%; }
    }
  </style>
</head>
<body>
  <nav class="sidebar">
    <h2>Dashboard</h2>
    <a class="nav-link" href="#temp1">Temperature 1</a>
    <a class="nav-link" href="#temp2">Temperature 2</a>
    <a class="nav-link" href="#temp3">Temperature 3</a>
    <a class="nav-link" href="#moisture">Moisture Level</a>
    <h2>General</h2>
    <a class="nav-link" href="#overview">General Overview</a>
  </nav>

  <div class="content">
    <header>
      Development and Implementation of a Wireless Monitoring System for Theobroma Cacao Drying Process
    </header>

    <section class="section" id="livecards">
      <div class="data-box">
        <div class="sensor-card"><h3>Temperature 1</h3><p id="temperature1">--</p></div>
        <div class="sensor-card"><h3>Temperature 2</h3><p id="temperature2">--</p></div>
        <div class="sensor-card"><h3>Temperature 3</h3><p id="temperature3">--</p></div>
        <div class="sensor-card"><h3>Moisture</h3><p id="moisture">--</p></div>
        <div class="sensor-card"><h3>Weather</h3><p id="weather">Loading‚Ä¶</p></div>
      </div>
    </section>

    <section class="section" id="temp1">
      <h3>üå°Ô∏è Temperature 1 Trend</h3>
      <canvas id="tempChart1"></canvas>
    </section>
    <section class="section" id="temp2">
      <h3>üå°Ô∏è Temperature 2 Trend</h3>
      <canvas id="tempChart2"></canvas>
    </section>
    <section class="section" id="temp3">
      <h3>üå°Ô∏è Temperature 3 Trend</h3>
      <canvas id="tempChart3"></canvas>
    </section>
    <section class="section" id="moisture">
      <h3>üíß Moisture Level Trend</h3>
      <canvas id="moistureChart"></canvas>
    </section>
    <section class="section" id="overview">
      <h3>üìä General Overview (Last 24‚ÄØh)</h3>
      <table>
        <thead>
          <tr>
            <th>Metric</th><th>Min</th><th>Max</th><th>Average</th>
          </tr>
        </thead>
        <tbody id="overviewBody">
          <tr><td>Temperature 1 (¬∞C)</td><td colspan="3">Loading‚Ä¶</td></tr>
          <tr><td>Temperature 2 (¬∞C)</td><td colspan="3">Loading‚Ä¶</td></tr>
          <tr><td>Temperature 3 (¬∞C)</td><td colspan="3">Loading‚Ä¶</td></tr>
          <tr><td>Moisture (%)</td><td colspan="3">Loading‚Ä¶</td></tr>
        </tbody>
      </table>
    </section>

    <footer>
      &copy; 2025 Cacao Drying Monitoring‚Ä¢ Powered by ThingSpeak & OpenWeather
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const channelID = "2770965";
    const readAPI   = "LJ902FFDJSJOBZYJ";
    const weatherKey = "YOUR_OPENWEATHERMAP_API_KEY"; // Replace with your key
    const city = "Cebu,PH";

    async function fetchLiveData() {
      const url = `https://api.thingspeak.com/channels/${channelID}/feeds/last.json?api_key=${readAPI}`;
      const res = await fetch(url);
      const d   = await res.json();
      document.getElementById('temperature1').textContent = `${d.field1}¬∞C`;
      document.getElementById('temperature2').textContent = `${d.field2}¬∞C`;
      document.getElementById('temperature3').textContent = `${d.field3}¬∞C`;
      document.getElementById('moisture').textContent     = `${d.field4}%`;
    }

    async function fetchWeather() {
      const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${weatherKey}&units=metric`;
      try {
        const res = await fetch(url);
        const d = await res.json();
        const desc = d.weather[0].description;
        const temp = d.main.temp;
        document.getElementById('weather').textContent = `${desc}, ${temp}¬∞C`;
      } catch (err) {
        document.getElementById('weather').textContent = "Error loading weather";
      }
    }

    fetchLiveData();
    fetchWeather();
    setInterval(() => {
      fetchLiveData();
      fetchWeather();
    }, 20000);
  </script>
</body>
</html>
